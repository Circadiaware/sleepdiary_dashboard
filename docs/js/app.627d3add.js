(function(t){function e(e){for(var n,o,s=e[0],l=e[1],c=e[2],v=0,_=[];v<s.length;v++)o=s[v],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&_.push(a[o][0]),a[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);d&&d(e);while(_.length)_.shift()();return r.push.apply(r,c||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,s=1;s<i.length;s++){var l=i[s];0!==a[l]&&(n=!1)}n&&(r.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},a={app:0},r=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/dashboard/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var d=l;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n,a,r=i("2b0e"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-app",[i("router-view",{on:{retitle:function(e){t.title=e},busy:function(e){t.busy=!0,t.progress=""},progress:function(e){t.progress=e+"%"},error:function(e){throw t.busy=!1,e},idle:function(e){t.busy=!1}}}),i("v-dialog",{attrs:{width:"400"},model:{value:t.error_dialog,callback:function(e){t.error_dialog=e},expression:"error_dialog"}},[i("v-card",[i("v-card-title",[i("v-icon",{attrs:{large:"",left:""}},[t._v(" mdi-emoticon-sad ")]),t._v(" An error occurred ")],1),i("v-card-text",[t._v(" Something went wrong with the app."),i("br"),t._v(" Please report the issue so we can fix it. "),i("v-list",{attrs:{dense:""}},[i("v-list-group",{scopedSlots:t._u([{key:"activator",fn:function(){return[i("v-list-item-title",[t._v("Advanced")])]},proxy:!0}])},[i("v-list-item",[i("v-list-item-content",{staticStyle:{"word-wrap":"anywhere"}},[t._v(" "+t._s(t.error_text)+" ")])],1)],1)],1)],1),i("v-card-actions",[i("v-btn",{attrs:{color:"primary",width:"50%",text:"",href:t.project_url+"dashboard/issues/new?title=App+threw+an+error&body="+encodeURIComponent(t.error)}},[i("v-icon",[t._v("mdi-bug")]),t._v(" Report this bug ")],1),i("v-btn",{attrs:{color:"primary",width:"50%",text:""},on:{click:t.reload}},[i("v-icon",[t._v("mdi-refresh")]),t._v(" Reload page ")],1)],1)],1)],1),i("v-bottom-navigation",{attrs:{color:"primary",grow:"",fixed:""},model:{value:t.section,callback:function(e){t.section=e},expression:"section"}},[i("v-btn",{attrs:{value:"Load",to:"/"}},[i("span",[t._v("Load")]),i("v-icon",[t._v("mdi-calendar-import")])],1),i("v-btn",{attrs:{value:"Info",to:"/info",disabled:t.need_diary}},[i("span",[t._v("Info")]),i("v-icon",[t._v("mdi-chart-timeline")])],1),i("v-btn",{attrs:{value:"Convert",to:"/convert",disabled:t.need_diary}},[i("span",[t._v("Convert")]),i("v-icon",[t._v("mdi-calendar-export")])],1),i("v-btn",{attrs:{value:"About",to:"/about"}},[i("span",[t._v("About")]),i("v-icon",[t._v("mdi-information")])],1)],1),i("v-overlay",{attrs:{value:t.busy}},[i("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:"100"}},[t._v(" "+t._s(t.progress)+" ")])],1)],1)},s=[],l=(i("b0c0"),i("e9c4"),i("d81d"),i("7039"),i("8c4f")),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-main",{staticStyle:{"padding-bottom":"56px"}},[i("div",{staticStyle:{display:"none"}},[i("input",{ref:"opener",attrs:{type:"file",accept:t.supported_extensions,multiple:""},on:{change:t.add_diaries}})]),i("div",{staticClass:"d-flex flex-column justify-center",staticStyle:{height:"100%",margin:"auto","max-width":"600px"}},[t.diaries.length?i("v-list",{staticStyle:{margin:"auto",padding:"1em"},attrs:{"two-line":""}},t._l(t.diaries,(function(e){var n=e[0],a=e[1],r=e[2];return i("v-list-item",{key:n},[i("v-list-item-avatar",[r.icon?i("v-icon",[t._v(t._s(r.icon))]):r.logo?i("v-img",{attrs:{src:r.logo}}):i("span",[t._v(" "+t._s(r.name.substr(0,1))+" ")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(r.title))]),i("v-list-item-subtitle",[t._v("Last updated "+t._s(t.get_last_update(a)))])],1),i("v-list-item-action",{on:{click:function(e){return t.remove_diary(n)}}},[i("v-btn",{attrs:{icon:""}},[i("v-icon",[t._v(" mdi-delete ")])],1)],1)],1)})),1):t._e(),i("div",{class:t.diaries.length?"mt-8 mb-16":"",staticStyle:{"text-align":"center"}},[i("v-btn",{attrs:{color:"primary"},on:{click:function(e){return t.$refs.opener.click()}}},[t._v(" Add a diary or spreadsheet ")]),t.diaries.length?t._e():i("p",{staticClass:"mt-6"},[t._v(" Don't have a diary yet?"),i("br"),i("a",{attrs:{href:t.docs_url+"create"}},[t._v("Create a diary")]),t._v(" or "),i("a",{attrs:{href:"#demo"},on:{click:function(e){e.preventDefault(),t.demo_popup=!0}}},[t._v("try an example")])])],1)],1),i("v-dialog",{attrs:{width:"400"},model:{value:t.demo_popup,callback:function(e){t.demo_popup=e},expression:"demo_popup"}},[i("v-card",[i("v-card-title",{staticClass:"text-h5"},[t._v(" Choose a diary... ")]),i("v-card-text",[t.common_sleep_diaries?i("v-list",[i("v-list-item-group",t._l(t.common_sleep_diaries,(function(e){return i("v-list-item",{key:e.filename,on:{click:function(i){return t.load_demo(e.filename)}}},[i("v-list-item-content",[i("v-list-item-title",{domProps:{textContent:t._s(e.short_title.replace(/^(.)/,(function(t,e){return e.toUpperCase()})))}})],1)],1)})),1)],1):[t._v(" Could not load the list of demo files."),i("br"),t._v(" Please try again later. ")]],2),i("v-card-actions",[i("v-btn",{attrs:{color:"primary",width:"100%",text:""},on:{click:function(e){t.demo_popup=!1}}},[i("v-icon",[t._v("mdi-close")]),t._v(" Close ")],1)],1)],1)],1),i("v-dialog",{attrs:{width:"400"},model:{value:t.error,callback:function(e){t.error=e},expression:"error"}},[i("v-card",[i("v-card-title",{staticClass:"text-h5"},[t._v(" Could not load diary ")]),i("v-card-text",[t._v(" This file does not appear to be in a supported format."),i("br"),t._v(" Please try a different file. ")]),i("v-card-actions",[i("v-btn",{attrs:{color:"primary",width:"100%",text:""},on:{click:function(e){t.error=!1}}},[i("v-icon",[t._v("mdi-close")]),t._v(" Close ")],1)],1)],1)],1)],1)},d=[],v=(i("a15b"),i("4e827"),i("4de4"),i("d3b7"),i("ac1f"),i("1276"),i("159b"),i("07ac"),i("841c"),i("fb6a"),i("a434"),function(){try{return window.sessionStorage||{}}catch(e){var t={};return{getItem:function(e){return t[e]},setItem:function(e,i){return t[e]=i}}}}()),_=(v.getItem("dashboard.diary")||"").split("\n").filter((function(t){return t.length})),u=[],m={},p=[],h=[],f={},g=0,b=[],y=0,w=function(t){Object.values(m).forEach((function(e){return e(1==u.length&&0==_.length,t)})),p.forEach((function(e){return e(1==u.length&&0==_.length,t)})),p.length=0},x=new window.DiaryLoader((function(t,e){if(!t.records.length)return w(!0);u.push([g++,t,t.format_info()]),y<b.length?(a=b[y++],x.load([a])):(a=0,b=[],w(!1),e.search&&!e.search(/^hash/)||--n,h&&!n&&(h.forEach((function(t){return t(1==u.length&&0==_.length)})),h=0)),e&&e!==f&&t.to_async("storage-line").then((function(t){_.push(t),v.setItem("dashboard.diary",_.join("\n"))}))}),(function(){var t=function(){return w(!0)},e=a;a=0,window.preprocess_activity_log&&window.Promise?window.preprocess_activity_log(e).then((function(t){x.load("ActivityStart,ActivityEnd\n"+t.map((function(t){return t.ActivityStart+","+t.ActivityEnd})).join("\n")+"\n")}),t):t()}),1);_.length?(n=_.length,_.forEach((function(t){return x.load(t,f)}))):h=0;var k={on_init:function(t){h?h.push(t):t(1==u.length&&0==_.length)},get_diaries:function(){return u},merge_diaries:function(){if(u.length){var t=u[0][1].clone();return u.slice(1).forEach((function(e){return t.merge(e[1])})),t}},add_callback:function(t){p.push(t)},add_permanent_callback:function(t,e){m[t]=e},add_diaries:function(t){b=t.target.files,a=b[0],y=1,x.load([a])},add_demo:function(t){fetch(t).then((function(t){return t.text()})).then((function(t){x.load(t.split("\n").filter((function(t){return t.search(/^2020-(?:1|0[3-9])|^2021/)})).join("\n"))}))},remove_diary:function(t){for(var e=0;e!=u.length;++e)if(u[e][0]==t)return u.splice(e,1),_.splice(e,1),v.setItem("dashboard.diary",_.join("\n")),void w(!1)},clear:function(){v.removeItem("dashboard.diary")}},V="sleepdiary",S="https://"+V+".github.io/",L="https://github.com/"+V+"/",C="../docs/",I={name:"Load",data:function(){return{supported_extensions:window.sleepdiary_engines.map((function(t){return t.extension})).join(",")+",.sqlite,.db,History",sleepdiary_engines:window.sleepdiary_engines.filter((function(t){return"Standard"!=t.name&&"ActivityLog"!=t.name})).sort((function(t,e){return t.title.localeCompare(e.title)})),activity_log:window.sleepdiary_engines.filter((function(t){return"ActivityLog"==t.name}))[0],trigger_rebuild:1,error:!1,docs_url:C,demo_popup:!1,common_sleep_diaries:0}},computed:{diaries:function(){return this.trigger_rebuild&&k.get_diaries()}},mounted:function(){var t=this;this.$emit("retitle","Load diary"),this.$emit("busy"),k.on_init((function(e,i){return t.on_diary_load(e,i)})),k.add_permanent_callback("load",(function(e,i){return t.on_diary_load(e,i)})),fetch("/resources/common_sleep_diaries.json").then((function(t){return t.json()})).then((function(e){return t.common_sleep_diaries=e}))},methods:{on_diary_load:function(t,e){this.$emit("idle"),e?this.error=!0:t?this.$router.push({path:"/info"}):++this.trigger_rebuild},add_diaries:function(t){this.$emit("busy"),k.add_diaries(t)},get_last_update:function(t){var e=t.to("Standard").records;return e.length?new Date(e[e.length-1].end||e[e.length-1].start).toISOString().split("T")[0]:"(never)"},remove_diary:function(t){k.remove_diary(t),++this.trigger_rebuild},load_demo:function(t){this.$emit("busy"),k.add_demo("/resources/common_sleep_diaries/"+t)}}},T=I,j=i("2877"),A=i("6544"),P=i.n(A),$=i("8336"),D=i("b0af"),O=i("99d9"),E=i("169a"),M=i("132d"),z=i("adda"),F=i("8860"),R=i("da13"),B=i("1800"),U=i("8270"),H=i("5d23"),N=i("1baa"),G=i("f6c4"),J=Object(j["a"])(T,c,d,!1,null,null,null),W=J.exports;P()(J,{VBtn:$["a"],VCard:D["a"],VCardActions:O["a"],VCardText:O["b"],VCardTitle:O["c"],VDialog:E["a"],VIcon:M["a"],VImg:z["a"],VList:F["a"],VListItem:R["a"],VListItemAction:B["a"],VListItemAvatar:U["a"],VListItemContent:H["a"],VListItemGroup:N["a"],VListItemSubtitle:H["b"],VListItemTitle:H["c"],VMain:G["a"]});var Z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-main",{staticStyle:{"padding-bottom":"56px"}},[i("div",{staticClass:"d-flex flex-column justify-center",staticStyle:{height:"100%","max-width":"600px",margin:"auto"}},[i("v-list",[i("v-subheader",[t._v("Statistics")]),i("v-list-item",[i("v-list-item-content",[t.recent_began?i("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",[i("th"),i("th",[t._v("Recent")]),i("th",[t._v("Long-term")]),i("th")])]),i("tbody",[i("tr",[i("th",[i("span",{staticClass:"wide"},[t._v("Date began")]),i("span",{staticClass:"narrow"},[t._v("Began")])]),i("td",[t._v(t._s(t.recent_began))]),i("td",[t._v(t._s(t.long_term_began))]),i("td",{staticClass:"hpad-unless-narrow"})]),t._l(t.schedule_list,(function(e){return i("tr",{key:e[3]},[i("th",[i("span",{staticClass:"wide"},[t._v(t._s(e[3]))]),i("span",{staticClass:"narrow"},[t._v(t._s(e[4]))])]),e[0]?i("td",[i("span",{attrs:{title:"average"}},[t._v(t._s(e[2]?e[0].mean.toFixed(2):t.to_duration(e[0].mean)))]),i("span",{staticClass:"space-unless-narrow"},[t._v("±")]),i("span",{attrs:{title:"standard deviation"}},[t._v(t._s(e[2]?e[0].standard_deviation.toFixed(2):t.to_duration(e[0].standard_deviation)))])]):i("td",[t._v("(no data)")]),e[1]?i("td",[i("span",{attrs:{title:"average"}},[t._v(t._s(e[2]?e[1].mean.toFixed(2):t.to_duration(e[1].mean)))]),i("span",{staticClass:"space-unless-narrow"},[t._v("±")]),i("span",{attrs:{title:"standard deviation"}},[t._v(t._s(e[2]?e[1].standard_deviation.toFixed(2):t.to_duration(e[1].standard_deviation)))])]):i("td",[t._v("(no data)")]),i("td",{staticClass:"hpad-unless-narrow"},[i("v-btn",{attrs:{icon:""},on:{click:function(i){return t.explain_schedules(e)}}},[i("v-icon",[t._v("mdi-information")])],1)],1)])})),i("tr",[i("th",[t._v("Timezone")]),i("td",{attrs:{colspan:"3"}},[i("v-autocomplete",{attrs:{items:t.timezones},model:{value:t.timezone,callback:function(e){t.timezone=e},expression:"timezone"}})],1)])],2)]},proxy:!0}],null,!1,4281344310)}):t._e()],1),i("v-dialog",{attrs:{"max-width":"400",scrollable:""},model:{value:t.explain_schedules_dialog,callback:function(e){t.explain_schedules_dialog=e},expression:"explain_schedules_dialog"}},[i("v-card",{attrs:{color:"#000022"}},[i("v-card-title",{staticClass:"text-h5"},[t._v(" "+t._s(t.explain_schedules_item[3])+" ")]),i("v-card-text",[i("p",[t._v("This row describes your "+t._s(t.explain_schedules_item[5])+".")]),t.explain_schedules_item[0]?i("p",[t._v(" The left-hand column only looks at the latest two weeks of data, so you can see how you're doing right now. "),i("br"),t._v(" It says that your average "+t._s(t.explain_schedules_item[5])+" since "+t._s(t.recent_began)+" was "+t._s(t.explain_schedules_item[2]?t.explain_schedules_item[0].mean.toFixed(2):t.to_duration(t.explain_schedules_item[0].mean))+", with a "),i("em",[t._v("standard deviation")]),t._v(" of "+t._s(t.explain_schedules_item[2]?t.explain_schedules_item[0].standard_deviation.toFixed(2):t.to_duration(t.explain_schedules_item[0].standard_deviation))+". ")]):t.explain_schedules_item[1]?i("p",[t._v("The left-hand column is empty because there isn't enough recent data.")]):t._e(),t.explain_schedules_item[1]?i("p",[t._v(" The right-hand column looks at all the data you've collected, so you can see long-term trends. "),i("br"),t._v(" It says that your average "+t._s(t.explain_schedules_item[5])+" since "+t._s(t.long_term_began)+" was "+t._s(t.explain_schedules_item[2]?t.explain_schedules_item[1].mean.toFixed(2):t.to_duration(t.explain_schedules_item[1].mean))+", with a "),i("em",[t._v("standard deviation")]),t._v(" of "+t._s(t.explain_schedules_item[2]?t.explain_schedules_item[1].standard_deviation.toFixed(2):t.to_duration(t.explain_schedules_item[1].standard_deviation))+". ")]):i("p",[t._v("There isn't enough data to calculate these values just yet - keep logging and it'll start to work!")])]),i("v-card-actions",[i("v-btn",{attrs:{color:"primary",width:"100%",text:""},on:{click:function(e){t.explain_schedules_dialog=!1}}},[i("v-icon",[t._v("mdi-close")]),t._v(" Close ")],1)],1)],1)],1)],1),i("v-list-item-group",[i("v-subheader",[t._v(" Sleep Chart "),i("v-spacer"),i("v-menu",{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,a=e.attrs;return[i("v-btn",t._g(t._b({attrs:{dark:"",icon:""},on:{click:function(e){t.sleep_chart_tab="root"}}},"v-btn",a,!1),n),[i("v-icon",[t._v("mdi-dots-vertical")])],1)]}}])},[i("v-tabs",{staticStyle:{width:"270px"},attrs:{height:"0"},model:{value:t.sleep_chart_tab,callback:function(e){t.sleep_chart_tab=e},expression:"sleep_chart_tab"}},[i("v-tabs-items",{model:{value:t.sleep_chart_tab,callback:function(e){t.sleep_chart_tab=e},expression:"sleep_chart_tab"}},[i("v-tab-item",{attrs:{transition:!1,value:"root"}},[i("v-list",{attrs:{flat:""}},[i("v-list-item",{on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="theme"}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-theme-light-dark")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Theme: "+t._s(t.sleep_chart_theme))])],1),i("v-list-item-action",[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-chevron-right")])],1)],1),i("v-list-item",{on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="start"}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-clock")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Start at: "+t._s(t.sleep_chart_start?"6pm":"midnight"))])],1),i("v-list-item-action",[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-chevron-right")])],1)],1),i("v-list-item",{on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="sort"}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-sort-calendar-ascending")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Sort by: "+t._s(t.sleep_chart_reverse?"oldest first":"newest first"))])],1),i("v-list-item-action",[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-chevron-right")])],1)],1)],1)],1),i("v-tab-item",{attrs:{transition:!1,value:"theme"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="root"}}},[i("v-icon",[t._v("mdi-arrow-left")])],1),i("v-toolbar-title",[t._v("Choose theme")])],1),i("v-divider"),i("v-list",[i("v-list-item-group",{model:{value:t.sleep_chart_theme,callback:function(e){t.sleep_chart_theme=e},expression:"sleep_chart_theme"}},[i("v-list-item",{attrs:{value:"dark"}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Dark")]),i("v-list-item-subtitle",[t._v("Easier to view in bed")])],1)],1),i("v-list-item",{attrs:{value:"light"}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Light")]),i("v-list-item-subtitle",[t._v("Looks better in print")])],1)],1)],1)],1)],1),i("v-tab-item",{attrs:{transition:!1,value:"start"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="root"}}},[i("v-icon",[t._v("mdi-arrow-left")])],1),i("v-toolbar-title",[t._v("Start time")])],1),i("v-divider"),i("v-list",[i("v-list-item-group",{model:{value:t.sleep_chart_start,callback:function(e){t.sleep_chart_start=e},expression:"sleep_chart_start"}},[i("v-list-item",{attrs:{value:648e5}},[i("v-list-item-content",[i("v-list-item-title",[t._v("6pm")]),i("v-list-item-subtitle",[t._v("Used by many sleep doctors")])],1)],1),i("v-list-item",{attrs:{value:0}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Midnight")]),i("v-list-item-subtitle",[t._v("Used by most lay people")])],1)],1)],1)],1)],1),i("v-tab-item",{attrs:{transition:!1,value:"sort"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="root"}}},[i("v-icon",[t._v("mdi-arrow-left")])],1),i("v-toolbar-title",[t._v("Sort by…")])],1),i("v-divider"),i("v-list",[i("v-list-item-group",{model:{value:t.sleep_chart_reverse,callback:function(e){t.sleep_chart_reverse=e},expression:"sleep_chart_reverse"}},[i("v-list-item",{attrs:{value:!0}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Oldest first")]),i("v-list-item-subtitle",[t._v("Earliest entries will appear at the top")])],1)],1),i("v-list-item",{attrs:{value:!1}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Newest first")]),i("v-list-item-subtitle",[t._v("Latest entries will appear at the top")])],1)],1)],1)],1)],1)],1)],1)],1)],1),i("v-list-item",[i("v-list-item-content",{domProps:{innerHTML:t._s(t.chart_svg[0])},on:{click:function(e){return t.show_svg(t.chart_svg[1],"Recent sleep graph")}}})],1),t.event_svg?[i("v-subheader",[t._v(" Sleep-related events "),i("v-spacer"),i("v-menu",{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,a=e.attrs;return[i("v-btn",t._g(t._b({attrs:{dark:"",icon:""},on:{click:function(e){t.event_graph_tab="root"}}},"v-btn",a,!1),n),[i("v-icon",[t._v("mdi-dots-vertical")])],1)]}}],null,!1,3692846904)},[i("v-tabs",{staticStyle:{width:"270px"},attrs:{height:"0"},model:{value:t.event_graph_tab,callback:function(e){t.event_graph_tab=e},expression:"event_graph_tab"}},[i("v-tabs-items",{model:{value:t.event_graph_tab,callback:function(e){t.event_graph_tab=e},expression:"event_graph_tab"}},[i("v-tab-item",{attrs:{transition:!1,value:"root"}},[i("v-list",{attrs:{flat:""}},[i("v-list-item",{on:{click:function(e){e.stopPropagation(),t.event_graph_tab="theme"}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-theme-light-dark")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Theme: "+t._s(t.event_graph_theme))])],1),i("v-list-item-action",[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-chevron-right")])],1)],1),i("v-list-item",{on:{click:function(e){e.stopPropagation(),t.event_graph_tab="lines"}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-chart-timeline-variant-shimmer")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Show "+t._s(t.event_graph_lines.length)+" lines")])],1),i("v-list-item-action",[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-chevron-right")])],1)],1)],1)],1),i("v-tab-item",{attrs:{transition:!1,value:"theme"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.event_graph_tab="root"}}},[i("v-icon",[t._v("mdi-arrow-left")])],1),i("v-toolbar-title",[t._v("Choose theme")])],1),i("v-divider"),i("v-list",[i("v-list-item-group",{model:{value:t.event_graph_theme,callback:function(e){t.event_graph_theme=e},expression:"event_graph_theme"}},[i("v-list-item",{attrs:{value:"dark"}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Dark")]),i("v-list-item-subtitle",[t._v("Easier to view in bed")])],1)],1),i("v-list-item",{attrs:{value:"light"}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Light")]),i("v-list-item-subtitle",[t._v("Looks better in print")])],1)],1)],1)],1)],1),i("v-tab-item",{attrs:{transition:!1,value:"lines"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.event_graph_tab="root"}}},[i("v-icon",[t._v("mdi-arrow-left")])],1),i("v-toolbar-title",[t._v("Show lines")])],1),i("v-divider"),i("v-list",{attrs:{flat:""}},[i("v-list-item-group",{attrs:{multiple:""},model:{value:t.event_graph_lines,callback:function(e){t.event_graph_lines=e},expression:"event_graph_lines"}},[t._l(t.event_graph_line_names,(function(e){return[i("v-list-item",{key:e,attrs:{value:e},on:{click:function(t){t.stopPropagation()}},scopedSlots:t._u([{key:"default",fn:function(n){var a=n.active;return[i("v-list-item-action",[i("v-checkbox",{attrs:{"input-value":a}})],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Show "+t._s(t.event_graph_line_title[e]))])],1)]}}],null,!0)})]}))],2)],1)],1)],1)],1)],1)],1),i("v-list-item",[i("v-list-item-content",{domProps:{innerHTML:t._s(t.event_svg)},on:{click:function(e){return t.show_svg(t.event_svg,"Sleep-related events")}}})],1)]:t._e(),i("v-subheader",[t._v("Reports")]),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-file-excel")])],1),i("v-list-item-content",{on:{click:function(e){return t.generate_predictions()}}},[i("v-list-item-title",[t._v("Predict upcoming sleeps")]),i("v-list-item-subtitle",[t._v("Spreadsheet based on average day length")])],1)],1),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-file-pdf-box")])],1),i("v-list-item-content",{on:{click:function(e){return t.generate_report()}}},[i("v-list-item-title",[t._v("Printable report")]),i("v-list-item-subtitle",[t._v("For sleep doctors")])],1)],1),t.patterns.length?i("v-subheader",[t._v("Possible patterns")]):t._e(),t._l(t.patterns,(function(e){return i("v-list-item",{key:e.id,attrs:{href:t.docs_url+"patterns/"+e.id}},[i("v-list-item-icon",[i("v-icon",[t._v(t._s(e.icon))])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(e.message))]),i("v-list-item-subtitle",[t._v("See advice about this pattern")])],1)],1)}))],2),i("v-dialog",{attrs:{scrollable:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("v-card",{attrs:{color:"#000022"}},[i("v-card-title",{staticClass:"text-h5"},[t._v(" "+t._s(t.dialog_title)+" ")]),i("v-card-text",{staticStyle:{"max-height":"70vh"},domProps:{innerHTML:t._s(t.dialog_svg)}}),i("v-card-actions",[i("v-btn",{attrs:{width:"50%",text:""},on:{click:t.download_svg}},[i("v-icon",[t._v("mdi-download")]),t._v(" Download ")],1),i("v-btn",{attrs:{color:"primary",width:"50%",text:""},on:{click:function(e){t.dialog=!1}}},[i("v-icon",[t._v("mdi-close")]),t._v(" Close ")],1)],1)],1)],1)],1)],1)])},q=[];i("5319"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("0eb6"),i("b7ef"),i("8bd4");function K(){return new Worker(i.p+"js/info.66728122.worker.js")}var Q=36e5,X={name:"Info",data:function(){return{timezone:(new Intl.DateTimeFormat).resolvedOptions().timeZone,timezones:[(new Intl.DateTimeFormat).resolvedOptions().timeZone],recent_began:"",long_term_began:"",explain_schedules_dialog:!1,explain_schedules_item:[],software_version:"",update_timeout:null,latest_primary_sleep:[],schedule_list:[],chart_svg:["",""],event_svg:"",dialog_svg:["",""],patterns:[],dialog:!1,dialog_title:"",awake_at:0,asleep_at:0,day_length:0,docs_url:C,worker:new K,sleep_chart_tab:"root",sleep_chart_theme:"dark",sleep_chart_start:648e5,sleep_chart_reverse:!0,event_graph_tab:"root",event_graph_theme:"dark",event_graph_lines:["wake","sleep","asleep","day-length"],event_graph_line_names:["wake","sleep","asleep","day-length"],event_graph_line_title:{wake:"wake times",sleep:"fall-asleep times",asleep:"sleep lengths","day-length":"day lengths"}}},mounted:function(){var t=this;this.worker.onmessage=function(e){var i=e.data;switch(i[0]){case 0:t.$emit("progress",i[1]);break;case 1:t.timezones=i[1],t.software_version=i[2],t.recent=i[3],t.long_term=i[4],t.event_svg=i[5],t.patterns=i[6],t.chart_svg=[i[7],i[8]],t.recent_began=t.recent.activities[0].id.split("T")[0],t.long_term_began=t.long_term.activities[0].id.split("T")[0],t.schedule_list=[[t.recent.summary_asleep,t.long_term.summary_asleep,0,"Total Sleep Time","Slept for","amount of sleep per day"],[t.recent.schedule.wake,t.long_term.schedule.wake,0,"Wake At","Woke up","wake time"],[t.recent.schedule.sleep,t.long_term.schedule.sleep,0,"Asleep At","Asleep","fall-asleep time"],[t.recent.summary_days,t.long_term.summary_days,0,"Day Length","Length","day length"],[t.recent.sleeps_per_day,t.long_term.sleeps_per_day,1,"Sleeps Per Day","Sleeps","number of sleeps per day"],[t.recent.meds_per_day,t.long_term.meds_per_day,1,"Medications Per Day","Meds","number of medications per day"]],t.$emit("idle");break;default:t.$emit("error",i[1]);break}},this.$emit("retitle","Info"),this.update_settings(),k.on_init((function(){k.get_diaries().length?t.update_diary():(t.$emit("idle"),t.$router.replace({path:"/"}))}))},watch:{timezone:function(){this.update_settings()},sleep_chart_theme:function(){this.update_settings()},sleep_chart_start:function(){this.update_settings()},sleep_chart_reverse:function(){this.update_settings()},event_graph_theme:function(){this.update_settings()},event_graph_lines:function(){this.update_settings()}},methods:{explain_schedules:function(t){this.explain_schedules_dialog=!0,this.explain_schedules_item=t},fix_timezone:function(t){return new Date(new Intl.DateTimeFormat("sv-SE",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",dayPeriod:"long",timeZone:this.timezone}).format(t))},update_diary:function(){this.worker.postMessage(["diary",k.merge_diaries().to("storage-line")])},generate_predictions:function(){var t=this;window.prediction_spreadsheet(new window.ExcelJS.Workbook,this.recent).xlsx.writeBuffer().then((function(e){return t.download_item("Sleep Predictions.xlsx",URL.createObjectURL(new Blob([e])))}))},generate_report:function(){var t=window.sleepdiary_report({pdf:new window.jspdf.jsPDF,timezone:this.timezone,software_version:this.software_version,recent:this.recent,long_term:this.long_term});this.download_item(t.filename,t.pdf.output("datauristring",{filename:t.filename}))},show_svg:function(t,e){this.dialog_svg=t,this.dialog_title=e,this.dialog=!0},download_svg:function(){this.dialog=!1,this.download_item(this.dialog_title+".svg","data:image/svg+xml;base64,"+btoa(this.dialog_svg))},download_item:function(t,e){var i=document.createElement("A");i.setAttribute("download",t),i.setAttribute("href",e),i.click()},to_duration:function(t){var e=Math.floor(t/Q),i=Math.floor(t/6e4)%60;return e+(i<10?":0":":")+i},to_approximate_time:function(t){var e=new Date(t),i=e.getHours(),n=e.toLocaleDateString()+", ";switch(i){case 0:return n+"midnight-01:00";case 9:return n+"0"+i+":00-"+(i+1)+":00";case 23:return n+"23:00-midnight";default:return i<9?n+"0"+i+":00-0"+(i+1)+":00":n+i+":00-"+(i+1)+":00"}},update_settings:function(){this.$emit("busy"),this.worker.postMessage(["settings",this.timezone,this.sleep_chart_theme,this.sleep_chart_start,this.sleep_chart_reverse,this.event_graph_theme,this.event_graph_lines])}}},Y=X,tt=(i("9e66"),i("c6a6")),et=i("ac7c"),it=i("ce7e"),nt=i("34c3"),at=i("e449"),rt=i("1f4f"),ot=i("2fa4"),st=i("e0c7"),lt=i("c671"),ct=i("fe57"),dt=i("aac8"),vt=i("71d9"),_t=i("2a7f"),ut=Object(j["a"])(Y,Z,q,!1,null,null,null),mt=ut.exports;P()(ut,{VAutocomplete:tt["a"],VBtn:$["a"],VCard:D["a"],VCardActions:O["a"],VCardText:O["b"],VCardTitle:O["c"],VCheckbox:et["a"],VDialog:E["a"],VDivider:it["a"],VIcon:M["a"],VList:F["a"],VListItem:R["a"],VListItemAction:B["a"],VListItemContent:H["a"],VListItemGroup:N["a"],VListItemIcon:nt["a"],VListItemSubtitle:H["b"],VListItemTitle:H["c"],VMain:G["a"],VMenu:at["a"],VSimpleTable:rt["a"],VSpacer:ot["a"],VSubheader:st["a"],VTabItem:lt["a"],VTabs:ct["a"],VTabsItems:dt["a"],VToolbar:vt["a"],VToolbarTitle:_t["a"]});var pt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-main",{staticStyle:{"padding-bottom":"56px"}},[i("div",{staticClass:"d-flex flex-column justify-center",staticStyle:{height:"100%"}},[i("v-list",{staticStyle:{margin:"auto",padding:"1em",width:"400px","max-width":"100%"},attrs:{"one-line":""}},[t._l(t.sleepdiary_engines,(function(e){return i("v-list-item",{key:e.name,on:{click:function(i){return t.save_with(e)}}},[i("v-list-item-avatar",[e.icon?i("v-icon",[t._v(t._s(e.icon))]):e.logo?i("v-img",{attrs:{src:e.logo}}):i("span",[t._v(" "+t._s(e.name.substr(0,1))+" ")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(e.title))])],1)],1)})),i("v-list-item",{on:{click:t.save_as_spreadsheet}},[i("v-list-item-avatar",[i("v-img",{attrs:{src:"https://upload.wikimedia.org/wikipedia/commons/3/34/Microsoft_Office_Excel_%282019%E2%80%93present%29.svg"}})],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Spreadsheet")])],1)],1)],2)],1)])},ht=[],ft=(i("00b4"),{name:"Convert",data:function(){return{sleepdiary_engines:window.sleepdiary_engines.filter((function(t){return!/^(ActivityLog|Standard|Spreadsheet(?:Graph|Table))$/.test(t.name)})).sort((function(t,e){return t.title.localeCompare(e.title)})),format_info:{}}},methods:{save_with:function(t){var e=this;this.$emit("busy"),this.diary.to_async(t.name).then((function(i){return i.to_async("output").then((function(i){e.$emit("idle");var n=document.createElement("a");n.setAttribute("href",window.DiaryLoader.to_url(i)),n.setAttribute("download","diary"+t.extension),n.click()}))}))},save_as_spreadsheet:function(){var t=this;this.$emit("busy"),this.diary.to_async("spreadsheet").then((function(e){t.$emit("idle");var i=document.createElement("a");i.setAttribute("href",URL.createObjectURL(new Blob([e]))),i.setAttribute("download","diary.xlsx"),i.click()}))}},mounted:function(){var t=this;this.$emit("retitle","Save As..."),this.$emit("busy"),k.on_init((function(){t.$emit("idle"),k.get_diaries().length?(t.diary=k.merge_diaries(),t.format_info=t.diary?t.diary.format_info():0):t.$router.replace({path:"/"})}))}}),gt=ft,bt=Object(j["a"])(gt,pt,ht,!1,null,null,null),yt=bt.exports;P()(bt,{VIcon:M["a"],VImg:z["a"],VList:F["a"],VListItem:R["a"],VListItemAvatar:U["a"],VListItemContent:H["a"],VListItemTitle:H["c"],VMain:G["a"]});var wt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-main",{staticStyle:{"padding-bottom":"56px"}},[i("div",{staticClass:"d-flex flex-column justify-center",staticStyle:{height:"100%","max-width":"600px",margin:"auto"}},[i("v-list",[i("v-subheader",[t._v("About")]),i("v-list-item",{attrs:{href:t.project_url+"dashboard"}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-code-tags")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Source code")])],1)],1),i("v-list-item",{attrs:{href:t.project_url+"dashboard/blob/main/LICENSE"}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-copyright")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("License")])],1)],1),i("v-list-item",{attrs:{href:t.project_url+"dashboard/issues/new"}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-message")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Contact us")])],1)],1)],1)],1)])},xt=[],kt={name:"Info",data:function(){return{project_url:L,site_url:S}}},Vt=kt,St=Object(j["a"])(Vt,wt,xt,!1,null,null,null),Lt=St.exports;P()(St,{VIcon:M["a"],VList:F["a"],VListItem:R["a"],VListItemContent:H["a"],VListItemIcon:nt["a"],VListItemTitle:H["c"],VMain:G["a"],VSubheader:st["a"]}),r["a"].use(l["a"]);var Ct=[{path:"/",name:"Load",component:W},{path:"/info",name:"Info",component:mt},{path:"/convert",name:"Convert",component:yt},{path:"/about",name:"About",component:Lt}],It=new l["a"]({routes:Ct}),Tt=It,jt={name:"App",data:function(){return{section:"Load",title:"Dashboard",need_diary:!0,busy:!1,progress:void 0,project_url:L,error_dialog:0,error_text:"",error:""}},mounted:function(){var t=this;k.add_permanent_callback("app",(function(){t.need_diary=!k.get_diaries().length})),this.section=Tt.currentRoute.name,document.title=this.section+" - Sleep Diary Dashboard",Tt.afterEach((function(e){t.busy=!1,t.section=e.name,document.title=t.section+" - Sleep Diary Dashboard"}))},errorCaptured:function(t){this.error_text=JSON.stringify(Object.getOwnPropertyNames(t).map((function(e){return[e,t[e]]})),null," "),this.error="Let us know what you were doing when this bug happened:\n\n\n\n\n\nTechnical information:\nBrowser: "+navigator.userAgent+"\nLocation: "+window.location+"\nError message:\n"+this.error_text,this.error_dialog=!0},methods:{reload:function(){k.clear(),location.reload()}}},At=jt,Pt=i("7496"),$t=i("b81c"),Dt=i("56b0"),Ot=i("a797"),Et=i("490a"),Mt=Object(j["a"])(At,o,s,!1,null,null,null),zt=Mt.exports;P()(Mt,{VApp:Pt["a"],VBottomNavigation:$t["a"],VBtn:$["a"],VCard:D["a"],VCardActions:O["a"],VCardText:O["b"],VCardTitle:O["c"],VDialog:E["a"],VIcon:M["a"],VList:F["a"],VListGroup:Dt["a"],VListItem:R["a"],VListItemContent:H["a"],VListItemTitle:H["c"],VOverlay:Ot["a"],VProgressCircular:Et["a"]});var Ft=i("f309");r["a"].use(Ft["a"]);var Rt=new Ft["a"]({theme:{dark:!0}});r["a"].config.productionTip=!1,new r["a"]({vuetify:Rt,router:Tt,render:function(t){return t(zt)}}).$mount("#app")},"9e66":function(t,e,i){"use strict";i("a3db")},a3db:function(t,e,i){}});
//# sourceMappingURL=app.627d3add.js.map