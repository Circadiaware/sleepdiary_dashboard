(function(t){function e(e){for(var n,o,s=e[0],l=e[1],c=e[2],d=0,_=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&_.push(a[o][0]),a[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);v&&v(e);while(_.length)_.shift()();return r.push.apply(r,c||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,s=1;s<i.length;s++){var l=i[s];0!==a[l]&&(n=!1)}n&&(r.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},a={app:0},r=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/dashboard/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var v=l;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n,a,r=i("2b0e"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-app",[i("router-view",{on:{retitle:function(e){t.title=e},busy:function(e){t.busy=!0,t.progress=""},progress:function(e){t.progress=e+"%"},error:function(e){throw t.busy=!1,e},idle:function(e){t.busy=!1}}}),i("v-dialog",{attrs:{width:"400"},model:{value:t.error_dialog,callback:function(e){t.error_dialog=e},expression:"error_dialog"}},[i("v-card",[i("v-card-title",[i("v-icon",{attrs:{large:"",left:""}},[t._v(" mdi-emoticon-sad ")]),t._v(" An error occurred ")],1),i("v-card-text",[t._v(" Something went wrong with the app."),i("br"),t._v(" Please report the issue so we can fix it. "),i("v-list",{attrs:{dense:""}},[i("v-list-group",{scopedSlots:t._u([{key:"activator",fn:function(){return[i("v-list-item-title",[t._v("Advanced")])]},proxy:!0}])},[i("v-list-item",[i("v-list-item-content",{staticStyle:{"word-wrap":"anywhere"}},[t._v(" "+t._s(t.error_text)+" ")])],1)],1)],1)],1),i("v-card-actions",[i("v-btn",{attrs:{color:"primary",width:"50%",text:"",href:t.project_url+"dashboard/issues/new?title=App+threw+an+error&body="+encodeURIComponent(t.error)}},[i("v-icon",[t._v("mdi-bug")]),t._v(" Report this bug ")],1),i("v-btn",{attrs:{color:"primary",width:"50%",text:""},on:{click:t.reload}},[i("v-icon",[t._v("mdi-refresh")]),t._v(" Reload page ")],1)],1)],1)],1),i("v-bottom-navigation",{attrs:{color:"primary",grow:"",fixed:""},model:{value:t.section,callback:function(e){t.section=e},expression:"section"}},[i("v-btn",{attrs:{value:"Load",to:"/"}},[i("span",[t._v("Load")]),i("v-icon",[t._v("mdi-calendar-import")])],1),i("v-btn",{attrs:{value:"Info",to:"/info",disabled:t.need_diary}},[i("span",[t._v("Info")]),i("v-icon",[t._v("mdi-chart-timeline")])],1),i("v-btn",{attrs:{value:"Convert",to:"/convert",disabled:t.need_diary}},[i("span",[t._v("Convert")]),i("v-icon",[t._v("mdi-calendar-export")])],1),i("v-btn",{attrs:{value:"About",to:"/about"}},[i("span",[t._v("About")]),i("v-icon",[t._v("mdi-information")])],1)],1),i("v-overlay",{attrs:{value:t.busy}},[i("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:"100"}},[t._v(" "+t._s(t.progress)+" ")])],1)],1)},s=[],l=(i("b0c0"),i("d81d"),i("7039"),i("8c4f")),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-main",{staticStyle:{"padding-bottom":"56px"}},[i("div",{staticStyle:{display:"none"}},[i("input",{ref:"opener",attrs:{type:"file",accept:t.supported_extensions},on:{change:t.add_diary}})]),i("div",{staticClass:"d-flex flex-column justify-center",staticStyle:{height:"100%",margin:"auto","max-width":"600px"}},[t.diaries.length?i("v-list",{staticStyle:{margin:"auto",padding:"1em"},attrs:{"two-line":""}},t._l(t.diaries,(function(e){var n=e[0],a=e[1],r=e[2];return i("v-list-item",{key:n},[i("v-list-item-avatar",[r.icon?i("v-icon",[t._v(t._s(r.icon))]):r.logo?i("v-img",{attrs:{src:r.logo}}):i("span",[t._v(" "+t._s(r.name.substr(0,1))+" ")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(r.title))]),i("v-list-item-subtitle",[t._v("Last updated "+t._s(t.get_last_update(a)))])],1),i("v-list-item-action",{on:{click:function(e){return t.remove_diary(n)}}},[i("v-btn",{attrs:{icon:""}},[i("v-icon",[t._v(" mdi-delete ")])],1)],1)],1)})),1):t._e(),i("div",{staticClass:"mt-8",staticStyle:{"text-align":"center"}},[i("v-btn",{attrs:{color:"primary"},on:{click:function(e){return t.$refs.opener.click()}}},[t._v(" Add a diary or spreadsheet ")]),i("p",{staticClass:"mt-6"},[t._v("See "),i("a",{attrs:{href:t.wiki_url}},[t._v("the wiki")]),t._v(" for more information,"),i("br"),t._v("including supported formats"),i("br"),t._v("and how to create a diary")])],1)],1),i("v-dialog",{attrs:{width:"400"},model:{value:t.error,callback:function(e){t.error=e},expression:"error"}},[i("v-card",[i("v-card-title",{staticClass:"text-h5"},[t._v(" Could not load diary ")]),i("v-card-text",[t._v(" This file does not appear to be in a supported format."),i("br"),t._v(" Please try a different file. ")]),i("v-card-actions",[i("v-btn",{attrs:{color:"primary",width:"100%",text:""},on:{click:function(e){t.error=!1}}},[i("v-icon",[t._v("mdi-close")]),t._v(" Close ")],1)],1)],1)],1)],1)},v=[],d=(i("a15b"),i("4e827"),i("4de4"),i("ac1f"),i("1276"),i("159b"),i("07ac"),i("841c"),i("d3b7"),i("fb6a"),i("a434"),function(){try{return window.sessionStorage||{}}catch(e){var t={};return{getItem:function(e){return t[e]},setItem:function(e,i){return t[e]=i}}}}()),_=(d.getItem("dashboard.diary")||"").split("\n").filter((function(t){return t.length})),u=[],m={},p=[],h=[],g={},f=0,b=function(t){Object.values(m).forEach((function(e){return e(1==u.length&&0==_.length,t)})),p.forEach((function(e){return e(1==u.length&&0==_.length,t)})),p.length=0},y=new window.DiaryLoader((function(t,e){if(!t.records.length)return b(!0);a=0,u.push([f++,t,t.format_info()]),b(!1),e.search&&!e.search(/^hash/)||--n,h&&!n&&(h.forEach((function(t){return t(1==u.length&&0==_.length)})),h=0),e&&e!==g&&t.to_async("storage-line").then((function(t){_.push(t),d.setItem("dashboard.diary",_.join("\n"))}))}),(function(){var t=function(){return b(!0)},e=a;a=0,window.preprocess_activity_log&&window.Promise?window.preprocess_activity_log(e).then((function(t){y.load("ActivityStart,ActivityEnd\n"+t.map((function(t){return t.ActivityStart+","+t.ActivityEnd})).join("\n")+"\n")}),t):t()}),1);_.length?(n=_.length,_.forEach((function(t){return y.load(t,g)}))):h=0;var w={on_init:function(t){h?h.push(t):t(1==u.length&&0==_.length)},get_diaries:function(){return u},merge_diaries:function(){if(u.length){var t=u[0][1].clone();return u.slice(1).forEach((function(e){return t.merge(e[1])})),t}},add_callback:function(t){p.push(t)},add_permanent_callback:function(t,e){m[t]=e},add_diary:function(t){y.load(t),a=t.target.files[0]},remove_diary:function(t){for(var e=0;e!=u.length;++e)if(u[e][0]==t)return u.splice(e,1),_.splice(e,1),d.setItem("dashboard.diary",_.join("\n")),void b(!1)},clear:function(){d.removeItem("dashboard.diary")}},k="sleepdiary",x="https://"+k+".github.io/",V="https://github.com/"+k+"/",S=V+"info/wiki/",L={name:"Load",data:function(){return{supported_extensions:window.sleepdiary_engines.map((function(t){return t.extension})).join(",")+",.sqlite,.db,History",sleepdiary_engines:window.sleepdiary_engines.filter((function(t){return"Standard"!=t.name&&"ActivityLog"!=t.name})).sort((function(t,e){return t.title.localeCompare(e.title)})),activity_log:window.sleepdiary_engines.filter((function(t){return"ActivityLog"==t.name}))[0],trigger_rebuild:1,error:!1,wiki_url:S}},computed:{diaries:function(){return this.trigger_rebuild&&w.get_diaries()}},mounted:function(){var t=this;this.$emit("retitle","Load diary"),this.$emit("busy"),w.on_init((function(e,i){return t.on_diary_load(e,i)})),w.add_permanent_callback("load",(function(e,i){return t.on_diary_load(e,i)}))},methods:{on_diary_load:function(t,e){this.$emit("idle"),e?this.error=!0:t?this.$router.push({path:"/info"}):++this.trigger_rebuild},add_diary:function(t){this.$emit("busy"),w.add_diary(t)},get_last_update:function(t){var e=t.to("Standard").records;return e.length?new Date(e[e.length-1].end||e[e.length-1].start).toISOString().split("T")[0]:"(never)"},remove_diary:function(t){w.remove_diary(t),++this.trigger_rebuild}}},I=L,C=i("2877"),T=i("6544"),A=i.n(T),j=i("8336"),P=i("b0af"),O=i("99d9"),$=i("169a"),D=i("132d"),E=i("adda"),M=i("8860"),z=i("da13"),R=i("1800"),F=i("8270"),B=i("5d23"),U=i("f6c4"),H=Object(C["a"])(I,c,v,!1,null,null,null),N=H.exports;A()(H,{VBtn:j["a"],VCard:P["a"],VCardActions:O["a"],VCardText:O["b"],VCardTitle:O["c"],VDialog:$["a"],VIcon:D["a"],VImg:E["a"],VList:M["a"],VListItem:z["a"],VListItemAction:R["a"],VListItemAvatar:F["a"],VListItemContent:B["a"],VListItemSubtitle:B["b"],VListItemTitle:B["c"],VMain:U["a"]});var J=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-main",{staticStyle:{"padding-bottom":"56px"}},[i("div",{staticClass:"d-flex flex-column justify-center",staticStyle:{height:"100%","max-width":"600px",margin:"auto"}},[i("v-list",[i("v-subheader",[t._v("Statistics")]),i("v-list-item",[i("v-list-item-content",[t.recent_began?i("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",[i("th"),i("th",[t._v("Recent")]),i("th",[t._v("Long-term")])])]),i("tbody",[i("tr",[i("th",[t._v("Date began")]),i("td",[t._v(t._s(t.recent_began))]),i("td",[t._v(t._s(t.long_term_began))])]),t._l(t.schedule_list,(function(e){return i("tr",{key:e[3]},[i("th",[t._v(t._s(e[3]))]),e[0]?i("td",[i("span",{attrs:{title:"average"}},[t._v(t._s(e[2]?e[0].mean.toFixed(2):t.to_duration(e[0].mean)))]),t._v(" ± "),i("span",{attrs:{title:"standard deviation"}},[t._v(t._s(e[2]?e[0].standard_deviation.toFixed(2):t.to_duration(e[0].standard_deviation)))])]):i("td",[t._v("(no data)")]),e[1]?i("td",[i("span",{attrs:{title:"average"}},[t._v(t._s(e[2]?e[1].mean.toFixed(2):t.to_duration(e[1].mean)))]),t._v(" ± "),i("span",{attrs:{title:"standard deviation"}},[t._v(t._s(e[2]?e[1].standard_deviation.toFixed(2):t.to_duration(e[1].standard_deviation)))])]):i("td",[t._v("(no data)")])])})),i("tr",[i("th",[t._v("Timezone")]),i("td",{attrs:{colspan:"2"}},[i("v-autocomplete",{attrs:{items:t.timezones},model:{value:t.timezone,callback:function(e){t.timezone=e},expression:"timezone"}})],1)])],2)]},proxy:!0}],null,!1,2535862320)}):t._e()],1)],1),i("v-list-item-group",[i("v-subheader",[t._v(" Sleep Chart "),i("v-spacer"),i("v-menu",{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,a=e.attrs;return[i("v-btn",t._g(t._b({attrs:{dark:"",icon:""},on:{click:function(e){t.sleep_chart_tab="root"}}},"v-btn",a,!1),n),[i("v-icon",[t._v("mdi-dots-vertical")])],1)]}}])},[i("v-tabs",{staticStyle:{width:"270px"},attrs:{height:"0"},model:{value:t.sleep_chart_tab,callback:function(e){t.sleep_chart_tab=e},expression:"sleep_chart_tab"}},[i("v-tabs-items",{model:{value:t.sleep_chart_tab,callback:function(e){t.sleep_chart_tab=e},expression:"sleep_chart_tab"}},[i("v-tab-item",{attrs:{transition:!1,value:"root"}},[i("v-list",{attrs:{flat:""}},[i("v-list-item",{on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="theme"}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-theme-light-dark")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Theme: "+t._s(t.sleep_chart_theme))])],1),i("v-list-item-action",[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-chevron-right")])],1)],1),i("v-list-item",{on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="start"}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-clock")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Start at: "+t._s(t.sleep_chart_start?"6pm":"midnight"))])],1),i("v-list-item-action",[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-chevron-right")])],1)],1),i("v-list-item",{on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="sort"}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-sort-calendar-ascending")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Sort by: "+t._s(t.sleep_chart_reverse?"oldest first":"newest first"))])],1),i("v-list-item-action",[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-chevron-right")])],1)],1)],1)],1),i("v-tab-item",{attrs:{transition:!1,value:"theme"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="root"}}},[i("v-icon",[t._v("mdi-arrow-left")])],1),i("v-toolbar-title",[t._v("Choose theme")])],1),i("v-divider"),i("v-list",[i("v-list-item-group",{model:{value:t.sleep_chart_theme,callback:function(e){t.sleep_chart_theme=e},expression:"sleep_chart_theme"}},[i("v-list-item",{attrs:{value:"dark"}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Dark")]),i("v-list-item-subtitle",[t._v("Easier to view in bed")])],1)],1),i("v-list-item",{attrs:{value:"light"}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Light")]),i("v-list-item-subtitle",[t._v("Looks better in print")])],1)],1)],1)],1)],1),i("v-tab-item",{attrs:{transition:!1,value:"start"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="root"}}},[i("v-icon",[t._v("mdi-arrow-left")])],1),i("v-toolbar-title",[t._v("Start time")])],1),i("v-divider"),i("v-list",[i("v-list-item-group",{model:{value:t.sleep_chart_start,callback:function(e){t.sleep_chart_start=e},expression:"sleep_chart_start"}},[i("v-list-item",{attrs:{value:648e5}},[i("v-list-item-content",[i("v-list-item-title",[t._v("6pm")]),i("v-list-item-subtitle",[t._v("Used by many sleep doctors")])],1)],1),i("v-list-item",{attrs:{value:0}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Midnight")]),i("v-list-item-subtitle",[t._v("Used by most lay people")])],1)],1)],1)],1)],1),i("v-tab-item",{attrs:{transition:!1,value:"sort"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.sleep_chart_tab="root"}}},[i("v-icon",[t._v("mdi-arrow-left")])],1),i("v-toolbar-title",[t._v("Sort by…")])],1),i("v-divider"),i("v-list",[i("v-list-item-group",{model:{value:t.sleep_chart_reverse,callback:function(e){t.sleep_chart_reverse=e},expression:"sleep_chart_reverse"}},[i("v-list-item",{attrs:{value:!0}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Oldest first")]),i("v-list-item-subtitle",[t._v("Earliest entries will appear at the top")])],1)],1),i("v-list-item",{attrs:{value:!1}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Newest first")]),i("v-list-item-subtitle",[t._v("Latest entries will appear at the top")])],1)],1)],1)],1)],1)],1)],1)],1)],1),i("v-list-item",[i("v-list-item-content",{domProps:{innerHTML:t._s(t.chart_svg[0])},on:{click:function(e){return t.show_svg(t.chart_svg[1],"Recent sleep graph")}}})],1),t.event_svg?[i("v-subheader",[t._v(" Sleep-related events "),i("v-spacer"),i("v-menu",{attrs:{bottom:"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,a=e.attrs;return[i("v-btn",t._g(t._b({attrs:{dark:"",icon:""},on:{click:function(e){t.event_graph_tab="root"}}},"v-btn",a,!1),n),[i("v-icon",[t._v("mdi-dots-vertical")])],1)]}}],null,!1,3692846904)},[i("v-tabs",{staticStyle:{width:"270px"},attrs:{height:"0"},model:{value:t.event_graph_tab,callback:function(e){t.event_graph_tab=e},expression:"event_graph_tab"}},[i("v-tabs-items",{model:{value:t.event_graph_tab,callback:function(e){t.event_graph_tab=e},expression:"event_graph_tab"}},[i("v-tab-item",{attrs:{transition:!1,value:"root"}},[i("v-list",{attrs:{flat:""}},[i("v-list-item",{on:{click:function(e){e.stopPropagation(),t.event_graph_tab="theme"}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-theme-light-dark")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Theme: "+t._s(t.event_graph_theme))])],1),i("v-list-item-action",[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-chevron-right")])],1)],1),i("v-list-item",{on:{click:function(e){e.stopPropagation(),t.event_graph_tab="lines"}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-chart-timeline-variant-shimmer")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Show "+t._s(t.event_graph_lines.length)+" lines")])],1),i("v-list-item-action",[i("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("mdi-chevron-right")])],1)],1)],1)],1),i("v-tab-item",{attrs:{transition:!1,value:"theme"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.event_graph_tab="root"}}},[i("v-icon",[t._v("mdi-arrow-left")])],1),i("v-toolbar-title",[t._v("Choose theme")])],1),i("v-divider"),i("v-list",[i("v-list-item-group",{model:{value:t.event_graph_theme,callback:function(e){t.event_graph_theme=e},expression:"event_graph_theme"}},[i("v-list-item",{attrs:{value:"dark"}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Dark")]),i("v-list-item-subtitle",[t._v("Easier to view in bed")])],1)],1),i("v-list-item",{attrs:{value:"light"}},[i("v-list-item-content",[i("v-list-item-title",[t._v("Light")]),i("v-list-item-subtitle",[t._v("Looks better in print")])],1)],1)],1)],1)],1),i("v-tab-item",{attrs:{transition:!1,value:"lines"}},[i("v-toolbar",{attrs:{flat:""}},[i("v-btn",{attrs:{icon:""},on:{click:function(e){e.stopPropagation(),t.event_graph_tab="root"}}},[i("v-icon",[t._v("mdi-arrow-left")])],1),i("v-toolbar-title",[t._v("Show lines")])],1),i("v-divider"),i("v-list",{attrs:{flat:""}},[i("v-list-item-group",{attrs:{multiple:""},model:{value:t.event_graph_lines,callback:function(e){t.event_graph_lines=e},expression:"event_graph_lines"}},[t._l(t.event_graph_line_names,(function(e){return[i("v-list-item",{key:e,attrs:{value:e},on:{click:function(t){t.stopPropagation()}},scopedSlots:t._u([{key:"default",fn:function(n){var a=n.active;return[i("v-list-item-action",[i("v-checkbox",{attrs:{"input-value":a}})],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Show "+t._s(t.event_graph_line_title[e]))])],1)]}}],null,!0)})]}))],2)],1)],1)],1)],1)],1)],1),i("v-list-item",[i("v-list-item-content",{domProps:{innerHTML:t._s(t.event_svg)},on:{click:function(e){return t.show_svg(t.event_svg,"Sleep-related events")}}})],1)]:t._e(),i("v-subheader",[t._v("Reports")]),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-file-excel")])],1),i("v-list-item-content",{on:{click:function(e){return t.generate_predictions()}}},[i("v-list-item-title",[t._v("Predict upcoming sleeps")]),i("v-list-item-subtitle",[t._v("Spreadsheet based on average day length")])],1)],1),i("v-list-item",[i("v-list-item-icon",[i("v-icon",[t._v("mdi-file-pdf")])],1),i("v-list-item-content",{on:{click:function(e){return t.generate_report()}}},[i("v-list-item-title",[t._v("Printable report")]),i("v-list-item-subtitle",[t._v("For sleep doctors")])],1)],1),t.patterns.length?i("v-subheader",[t._v("Possible patterns")]):t._e(),t._l(t.patterns,(function(e){return i("v-list-item",{key:e.id,attrs:{href:t.wiki_url+e.id}},[i("v-list-item-icon",[i("v-icon",[t._v(t._s(e.icon))])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(e.message))]),i("v-list-item-subtitle",[t._v("See advice on the wiki")])],1)],1)}))],2),i("v-dialog",{attrs:{scrollable:""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[i("v-card",{attrs:{color:"#000022"}},[i("v-card-title",{staticClass:"text-h5"},[t._v(" "+t._s(t.dialog_title)+" ")]),i("v-card-text",{staticStyle:{"max-height":"70vh"},domProps:{innerHTML:t._s(t.dialog_svg)}}),i("v-card-actions",[i("v-btn",{attrs:{width:"50%",text:""},on:{click:t.download_svg}},[i("v-icon",[t._v("mdi-download")]),t._v(" Download ")],1),i("v-btn",{attrs:{color:"primary",width:"50%",text:""},on:{click:function(e){t.dialog=!1}}},[i("v-icon",[t._v("mdi-close")]),t._v(" Close ")],1)],1)],1)],1)],1)],1)])},G=[];i("5319"),i("3ca3"),i("ddb0"),i("2b3d");function W(){return new Worker(i.p+"js/info.efda8e1d.worker.js")}var Z=36e5,q={name:"Info",data:function(){return{timezone:(new Intl.DateTimeFormat).resolvedOptions().timeZone,timezones:[(new Intl.DateTimeFormat).resolvedOptions().timeZone],recent_began:"",long_term_began:"",software_version:"",update_timeout:null,latest_primary_sleep:[],schedule_list:[],chart_svg:["",""],event_svg:"",dialog_svg:["",""],patterns:[],dialog:!1,dialog_title:"",awake_at:0,asleep_at:0,day_length:0,wiki_url:S,worker:new W,sleep_chart_tab:"root",sleep_chart_theme:"dark",sleep_chart_start:648e5,sleep_chart_reverse:!0,event_graph_tab:"root",event_graph_theme:"dark",event_graph_lines:["wake","sleep","asleep","day-length"],event_graph_line_names:["wake","sleep","asleep","day-length"],event_graph_line_title:{wake:"wake times",sleep:"fall-asleep times",asleep:"sleep lengths","day-length":"day lengths"}}},mounted:function(){var t=this;this.worker.onmessage=function(e){var i=e.data;switch(i[0]){case 0:t.$emit("progress",i[1]);break;case 1:t.timezones=i[1],t.software_version=i[2],t.recent=i[3],t.long_term=i[4],t.event_svg=i[5],t.patterns=i[6],t.chart_svg=[i[7],i[8]],t.recent_began=t.recent.activities[0].id.split("T")[0],t.long_term_began=t.long_term.activities[0].id.split("T")[0],t.schedule_list=[[t.recent.summary_asleep,t.long_term.summary_asleep,0,"Total Sleep Time"],[t.recent.schedule.wake,t.long_term.schedule.wake,0,"Wake At"],[t.recent.schedule.sleep,t.long_term.schedule.sleep,0,"Asleep At"],[t.recent.summary_days,t.long_term.summary_days,0,"Day Length"],[t.recent.sleeps_per_day,t.long_term.sleeps_per_day,1,"Sleeps Per Day"],[t.recent.meds_per_day,t.long_term.meds_per_day,1,"Medications Per Day"]],t.$emit("idle");break;default:t.$emit("error",i[1]);break}},this.$emit("retitle","Info"),this.update_settings(),w.on_init((function(){w.get_diaries().length?t.update_diary():(t.$emit("idle"),t.$router.replace({path:"/"}))}))},watch:{timezone:function(){this.update_settings()},sleep_chart_theme:function(){this.update_settings()},sleep_chart_start:function(){this.update_settings()},sleep_chart_reverse:function(){this.update_settings()},event_graph_theme:function(){this.update_settings()},event_graph_lines:function(){this.update_settings()}},methods:{fix_timezone:function(t){return new Date(new Intl.DateTimeFormat("sv-SE",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",dayPeriod:"long",timeZone:this.timezone}).format(t))},update_diary:function(){this.worker.postMessage(["diary",w.merge_diaries().to("storage-line")])},generate_predictions:function(){var t=this;window.prediction_spreadsheet(new window.ExcelJS.Workbook,this.recent).xlsx.writeBuffer().then((function(e){return t.download_item("Sleep Predictions.xlsx",URL.createObjectURL(new Blob([e])))}))},generate_report:function(){var t=window.sleepdiary_report({pdf:new window.jspdf.jsPDF,timezone:this.timezone,software_version:this.software_version,recent:this.recent,long_term:this.long_term});this.download_item(t.filename,t.pdf.output("datauristring",{filename:t.filename}))},show_svg:function(t,e){this.dialog_svg=t,this.dialog_title=e,this.dialog=!0},download_svg:function(){this.dialog=!1,this.download_item(this.dialog_title+".svg","data:image/svg+xml;base64,"+btoa(this.dialog_svg))},download_item:function(t,e){var i=document.createElement("A");i.setAttribute("download",t),i.setAttribute("href",e),i.click()},to_duration:function(t){var e=Math.floor(t/Z),i=Math.floor(t/6e4)%60;return e+(i<10?":0":":")+i},to_approximate_time:function(t){var e=new Date(t),i=e.getHours(),n=e.toLocaleDateString()+", ";switch(i){case 0:return n+"midnight-01:00";case 9:return n+"0"+i+":00-"+(i+1)+":00";case 23:return n+"23:00-midnight";default:return i<9?n+"0"+i+":00-0"+(i+1)+":00":n+i+":00-"+(i+1)+":00"}},update_settings:function(){this.$emit("busy"),this.worker.postMessage(["settings",this.timezone,this.sleep_chart_theme,this.sleep_chart_start,this.sleep_chart_reverse,this.event_graph_theme,this.event_graph_lines])}}},K=q,Q=i("c6a6"),X=i("ac7c"),Y=i("ce7e"),tt=i("1baa"),et=i("34c3"),it=i("e449"),nt=i("1f4f"),at=i("2fa4"),rt=i("e0c7"),ot=i("c671"),st=i("fe57"),lt=i("aac8"),ct=i("71d9"),vt=i("2a7f"),dt=Object(C["a"])(K,J,G,!1,null,null,null),_t=dt.exports;A()(dt,{VAutocomplete:Q["a"],VBtn:j["a"],VCard:P["a"],VCardActions:O["a"],VCardText:O["b"],VCardTitle:O["c"],VCheckbox:X["a"],VDialog:$["a"],VDivider:Y["a"],VIcon:D["a"],VList:M["a"],VListItem:z["a"],VListItemAction:R["a"],VListItemContent:B["a"],VListItemGroup:tt["a"],VListItemIcon:et["a"],VListItemSubtitle:B["b"],VListItemTitle:B["c"],VMain:U["a"],VMenu:it["a"],VSimpleTable:nt["a"],VSpacer:at["a"],VSubheader:rt["a"],VTabItem:ot["a"],VTabs:st["a"],VTabsItems:lt["a"],VToolbar:ct["a"],VToolbarTitle:vt["a"]});var ut=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-main",{staticStyle:{"padding-bottom":"56px"}},[i("div",{staticClass:"d-flex flex-column justify-center",staticStyle:{height:"100%"}},[i("v-list",{staticStyle:{margin:"auto",padding:"1em",width:"400px","max-width":"100%"},attrs:{"one-line":""}},[t._l(t.sleepdiary_engines,(function(e){return i("v-list-item",{key:e.name,on:{click:function(i){return t.save_with(e)}}},[i("v-list-item-avatar",[e.icon?i("v-icon",[t._v(t._s(e.icon))]):e.logo?i("v-img",{attrs:{src:e.logo}}):i("span",[t._v(" "+t._s(e.name.substr(0,1))+" ")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v(t._s(e.title))])],1)],1)})),i("v-list-item",{on:{click:t.save_as_spreadsheet}},[i("v-list-item-avatar",[i("v-img",{attrs:{src:"https://upload.wikimedia.org/wikipedia/commons/3/34/Microsoft_Office_Excel_%282019%E2%80%93present%29.svg"}})],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Spreadsheet")])],1)],1)],2)],1)])},mt=[],pt={name:"Convert",data:function(){return{sleepdiary_engines:window.sleepdiary_engines.filter((function(t){return!/^(ActivityLog|Standard|Spreadsheet(?:Graph|Table))$/.test(t.name)})).sort((function(t,e){return t.title.localeCompare(e.title)})),format_info:{}}},methods:{save_with:function(t){var e=this;this.$emit("busy"),this.diary.to_async(t.name).then((function(i){return i.to_async("output").then((function(i){e.$emit("idle");var n=document.createElement("a");n.setAttribute("href",window.DiaryLoader.to_url(i)),n.setAttribute("download","diary"+t.extension),n.click()}))}))},save_as_spreadsheet:function(){var t=this;this.$emit("busy"),this.diary.to_async("spreadsheet").then((function(e){t.$emit("idle");var i=document.createElement("a");i.setAttribute("href",URL.createObjectURL(new Blob([e]))),i.setAttribute("download","diary.xlsx"),i.click()}))}},mounted:function(){var t=this;this.$emit("retitle","Save As..."),this.$emit("busy"),w.on_init((function(){t.$emit("idle"),w.get_diaries().length?(t.diary=w.merge_diaries(),t.format_info=t.diary?t.diary.format_info():0):t.$router.replace({path:"/"})}))}},ht=pt,gt=Object(C["a"])(ht,ut,mt,!1,null,null,null),ft=gt.exports;A()(gt,{VIcon:D["a"],VImg:E["a"],VList:M["a"],VListItem:z["a"],VListItemAvatar:F["a"],VListItemContent:B["a"],VListItemTitle:B["c"],VMain:U["a"]});var bt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-main",{staticStyle:{"padding-bottom":"56px"}},[i("div",{staticClass:"d-flex flex-column justify-center",staticStyle:{height:"100%","max-width":"600px",margin:"auto"}},[i("v-list",[i("v-subheader",[t._v("About")]),i("v-list-item",{attrs:{href:t.project_url+"dashboard"}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-code-tags")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Source code")])],1)],1),i("v-list-item",{attrs:{href:t.project_url+"dashboard/blob/main/LICENSE"}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-copyright")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("License")])],1)],1),i("v-list-item",{attrs:{href:t.project_url+"dashboard/issues/new"}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-message")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Contact us")])],1)],1)],1)],1)])},yt=[],wt={name:"Info",data:function(){return{project_url:V,site_url:x}}},kt=wt,xt=Object(C["a"])(kt,bt,yt,!1,null,null,null),Vt=xt.exports;A()(xt,{VIcon:D["a"],VList:M["a"],VListItem:z["a"],VListItemContent:B["a"],VListItemIcon:et["a"],VListItemTitle:B["c"],VMain:U["a"],VSubheader:rt["a"]}),r["a"].use(l["a"]);var St=[{path:"/",name:"Load",component:N},{path:"/info",name:"Info",component:_t},{path:"/convert",name:"Convert",component:ft},{path:"/about",name:"About",component:Vt}],Lt=new l["a"]({routes:St}),It=Lt,Ct={name:"App",data:function(){return{section:"Load",title:"Dashboard",need_diary:!0,busy:!1,progress:void 0,project_url:V,error_dialog:0,error_text:"",error:""}},mounted:function(){var t=this;w.add_permanent_callback("app",(function(){t.need_diary=!w.get_diaries().length})),this.section=It.currentRoute.name,document.title=this.section+" - Sleep Diary Dashboard",It.afterEach((function(e){t.busy=!1,t.section=e.name,document.title=t.section+" - Sleep Diary Dashboard"}))},errorCaptured:function(t){this.error_text=JSON.stringify(Object.getOwnPropertyNames(t).map((function(e){return[e,t[e]]})),null," "),this.error="Let us know what you were doing when this bug happened:\n\n\n\n\n\nTechnical information:\nBrowser: "+navigator.userAgent+"\nLocation: "+window.location+"\nError message:\n"+this.error_text,this.error_dialog=!0},methods:{reload:function(){w.clear(),location.reload()}}},Tt=Ct,At=i("7496"),jt=i("b81c"),Pt=i("56b0"),Ot=i("a797"),$t=i("490a"),Dt=Object(C["a"])(Tt,o,s,!1,null,null,null),Et=Dt.exports;A()(Dt,{VApp:At["a"],VBottomNavigation:jt["a"],VBtn:j["a"],VCard:P["a"],VCardActions:O["a"],VCardText:O["b"],VCardTitle:O["c"],VDialog:$["a"],VIcon:D["a"],VList:M["a"],VListGroup:Pt["a"],VListItem:z["a"],VListItemContent:B["a"],VListItemTitle:B["c"],VOverlay:Ot["a"],VProgressCircular:$t["a"]});var Mt=i("f309");r["a"].use(Mt["a"]);var zt=new Mt["a"]({theme:{dark:!0}});r["a"].config.productionTip=!1,new r["a"]({vuetify:zt,router:It,render:function(t){return t(Et)}}).$mount("#app")}});
//# sourceMappingURL=app.6c2dc11b.js.map